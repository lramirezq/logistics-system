<div class="container">
  <div class="card" style="max-width: 800px; margin: 2rem auto;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
      <h2>Operación N° <%= @operation.numero_operacion %></h2>
      <div>
        <%= link_to "Editar", edit_operation_path(@operation), class: "btn btn-primary", style: "margin-right: 0.5rem;" %>
        <%= link_to "Volver", operations_path, class: "btn btn-secondary" %>
      </div>
    </div>

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
      <div>
        <h3>Información General</h3>
        <div class="form-group">
          <strong>Tipo de Operación:</strong> <%= @operation.tipo_operacion %>
        </div>
        <div class="form-group">
          <strong>Fecha:</strong> <%= @operation.fecha.strftime('%d/%m/%Y') if @operation.fecha %>
        </div>
        <div class="form-group">
          <strong>Shipper:</strong> <%= @operation.shipper&.nombre_comercial || @operation.shipper&.razon_social %>
        </div>
        <div class="form-group">
          <strong>Consignatario:</strong> <%= @operation.consignatario&.nombre_comercial || @operation.consignatario&.razon_social %>
        </div>
        <div class="form-group">
          <strong>Ref Cliente:</strong> <%= @operation.ref_cliente&.nombre_comercial || @operation.ref_cliente&.razon_social %>
        </div>
      </div>

      <div>
        <h3>Transporte</h3>
        <div class="form-group">
          <strong>Emisor Master:</strong> <%= @operation.emisor_master %>
        </div>
        <div class="form-group">
          <strong>Vessel/Vuelo:</strong> <%= @operation.vessel_vuelo %>
        </div>
        <div class="form-group">
          <strong>SALIDA/ETD:</strong> <%= @operation.etd.strftime('%d/%m/%Y') if @operation.etd %>
        </div>
        <div class="form-group">
          <strong>LLEGADA/ETA:</strong> <%= @operation.eta.strftime('%d/%m/%Y') if @operation.eta %>
        </div>
        <div class="form-group">
          <strong>Origen:</strong> <%= @operation.origen %>
        </div>
        <div class="form-group">
          <strong>Destino:</strong> <%= @operation.destino %>
        </div>
      </div>
    </div>

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-top: 2rem;">
      <div>
        <h3>Agentes y Compañías</h3>
        <div class="form-group">
          <strong>Agente:</strong> <%= @operation.agente&.nombre_comercial || @operation.agente&.razon_social %>
        </div>
        <div class="form-group">
          <strong>Compañía:</strong> <%= @operation.compania&.nombre_comercial || @operation.compania&.razon_social %>
        </div>
        <div class="form-group">
          <strong>Naviera:</strong> <%= @operation.naviera %>
        </div>
      </div>

      <div>
        <h3>Contenedor</h3>
        <div class="form-group">
          <strong>N° Contenedor:</strong> <%= @operation.numero_contenedor %>
        </div>
        <div class="form-group">
          <strong>Volumen:</strong> <%= @operation.volumen %>
        </div>
        <div class="form-group">
          <strong>Peso:</strong> <%= @operation.peso %>
        </div>
      </div>
    </div>

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-top: 2rem;">
      <div>
        <h3>B/L</h3>
        <div class="form-group">
          <strong>B/L Master:</strong> <%= @operation.bl_master %>
        </div>
        <div class="form-group">
          <strong>B/L Hijo:</strong> <%= @operation.bl_hijo %>
        </div>
      </div>

      <div>
        <h3>Facturación</h3>
        <div class="form-group">
          <strong>FACT_AFECTA:</strong> $<%= number_with_delimiter(@operation.fact_afecta) if @operation.fact_afecta %>
        </div>
        <div class="form-group">
          <strong>FACT_EXENTA:</strong> $<%= number_with_delimiter(@operation.fact_exenta) if @operation.fact_exenta %>
        </div>
        <div class="form-group">
          <strong>FACT_EXTRANJ:</strong> $<%= number_with_delimiter(@operation.fact_extranj) if @operation.fact_extranj %>
        </div>
      </div>
    </div>

    <div style="margin-top: 2rem;">
      <h3>Compras</h3>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
        <div class="form-group">
          <strong>COMPRA_AFECTA:</strong> $<%= number_with_delimiter(@operation.compra_afecta) if @operation.compra_afecta %>
        </div>
        <div class="form-group">
          <strong>COMPRA_EXENTA:</strong> $<%= number_with_delimiter(@operation.compra_exenta) if @operation.compra_exenta %>
        </div>
      </div>
    </div>

    <% if @operation.observaciones.present? %>
      <div style="margin-top: 2rem;">
        <h3>Observaciones</h3>
        <div style="background-color: #f8fafc; padding: 1rem; border-radius: 4px; border-left: 4px solid #3b82f6;">
          <%= simple_format(@operation.observaciones) %>
        </div>
      </div>
    <% end %>

    <div style="margin-top: 2rem; padding-top: 1rem; border-top: 1px solid #e5e7eb; color: #6b7280; font-size: 0.875rem;">
      <strong>Creado:</strong> <%= @operation.created_at.strftime('%d/%m/%Y %H:%M') %>
      <% if @operation.updated_at != @operation.created_at %>
        | <strong>Actualizado:</strong> <%= @operation.updated_at.strftime('%d/%m/%Y %H:%M') %>
      <% end %>
    </div>
  </div>
</div>